<pdf>
    <header>
        <p style="text-align: left; color: #6A9D1B; font-size: 24px;font-weight: bold;">
            <span style="color: #204F95">LUCULLUS</span> <span style="color: #2296D2">Medical</span>
        </p>
        <p style="text-align: right">
            Zálohová faktúra<br/>
            <b>{ _id }</b>
        </p>
    </header>
    <main style="color:black;margin-left:1.2cm;margin-right:1.2cm;margin-top: 1.2cm;margin-bottom: 1.2cm;font-size: 12px;font-weight:light;line-height:1.35em;">
        {
            function round( number, precision )
            {
                return Math.round( number * Math.pow( 10, precision )) /  Math.pow( 10, precision );
            }

            function format_price( number, precision, style )
            {
                let price = number.toLocaleString( $locale, { style: 'currency', currency, ...( precision !== undefined ? { minimumFractionDigits: precision, maximumFractionDigits: precision } : undefined ) });

                if( style )
                {
                    price = price.replace(/(-?[0-9\s.,]+)/, '<span style="' + style +  '">$1</span>' );
                }

                return price;
            }

            function format_number( number, precision, style )
            {
                number = number.toLocaleString( $locale, { ...( precision !== undefined ? { minimumFractionDigits: precision, maximumFractionDigits: precision } : undefined ) });

                if( style )
                {
                    number = '<span style="' + style +  '">' + number + '</span>';
                }

                return number;
            }

            function format_date( date )
            {
                return new Date( date ).toLocaleDateString( $locale, { year: 'numeric', month: 'numeric', day: 'numeric' });
            }
        }
        <table style="margin-bottom: 7.2mm;">
            <tr>
                <td>
                    <img src="images/medical-logo.svg" style="padding-top: 1.7px;" />
                </td>
                <td style="text-align: right;line-height: 1.2em;">
                    <span style="font-size:16px;">
                        Zálohová faktúra<br/>
                        <b style="font-size: 18px;">{ _id }</b>
                    </span>
                </td>
            </tr>
        </table>/**/
        <table style="margin-bottom: 4.8mm;">
            <tr style="font-size:8px;color:#666;">
                <td colspan="2" style="padding-top:4.8mm;padding-bottom:1mm;font-weight: medium;">
                    DODÁVATEĽ:
                </td>
                <td colspan="2" style="padding-top:4.8mm;padding-left:4.8mm;padding-bottom:1mm;background-color:#f0f0f0;margin-right:-1.2cm;font-weight: medium;">
                    ODBERATEĽ:
                </td>
            </tr>
            <tr style="font-weight: bold;font-size: 14px;">
                <td colspan="2">
                    { seller.company || seller.name }
                </td>
                <td colspan="2" style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">
                    { buyer.company || buyer.name }
                </td>
            </tr>
            <tr style="line-height: 1.35em;">
                <td>
                    { seller.address }
                </td>
                <td rowspan="3">
                    <table>
                        <tr><td style="width:30%;text-align: right;padding-right:2mm;">IČO:</td><td style="width:80%">{ seller.crn }</td></tr>
                        <tr><td style="width:30%;text-align: right;padding-right:2mm;">DIČ:</td><td style="width:80%">{ seller.tax }</td></tr>
                        <tr><td style="width:30%;text-align: right;padding-right:2mm;">IČ DPH:</td><td style="width:80%">{ seller.vat }</td></tr>
                    </table>
                </td>
                <td style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">
                    { buyer.address }
                </td>
                <td rowspan="3" style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">
                    <table>
                        <tr><td style="width:30%;text-align: right;padding-right:2mm;background-color:#f0f0f0;">IČO:</td><td style="background-color:#f0f0f0;width:80%">TODO { seller.crn }</td></tr>
                        <tr><td style="width:30%;text-align: right;padding-right:2mm;background-color:#f0f0f0;">DIČ:</td><td style="background-color:#f0f0f0;width:80%">{ seller.tax }</td></tr>
                        <tr><td style="width:30%;text-align: right;padding-right:2mm;background-color:#f0f0f0;">IČ DPH:</td><td style="background-color:#f0f0f0;width:80%">{ seller.vat }</td></tr>
                    </table>
                </td>
            </tr>
            <tr style="line-height: 1.35em;">
                <td>
                    { seller.zip } { seller.city }
                </td>
                <td style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">
                    { buyer.zip } { seller.city }
                </td>
            </tr>
            <tr style="line-height: 1.35em;">
                <td>
                    { { "SK": "Slovensko" }[seller.country] }
                </td>
                <td style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">
                    { { "SK": "Slovensko" }[buyer.country] }
                </td>
            </tr>
            <tr style="font-size:9px;">
                <td colspan="2" style="padding-top:1mm;padding-bottom:4.8mm;padding-right: 4.8mm;color:#666;font-weight: normal;line-height: 1.25em;">
                    Spoločnosť je zapísaná v Obchodnom registri Okresného súdu Bratislava I,<br/>
                    Oddiel: Sro, Vložka číslo: 113755/B
                </td>
                <td colspan="2" style="padding-top:1mm;padding-bottom:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">
                    
                </td>
            </tr>
        </table>
        <div style="color: white;background-color: #66882f;background-color:brown;background-color:#365fa8;background-color: #204F95;margin-left: -1.2cm;padding-left: 1.2cm;margin-right: -1.2cm;margin-bottom:7.2mm;padding-right: 1.2cm;padding-top:7.2mm;padding-bottom:7.2mm;">
            <table>
                <tr>
                    <td>
                        Dátum vystavenia:
                    </td>
                    <td style="text-align: right;padding-right:4.8mm;">
                        { format_date( issued )}
                    </td>
                    <td style="padding-left:4.8mm;">
                        Číslo účtu:
                    </td>
                    <td style="padding-left:4.8mm;padding-right:4.8mm;text-align: right;">
                        seller.banks
                    </td>
                    <td rowspan="5" style="padding-left:4.8mm;">
                        <img src="images/qr.svg" style="padding-top: 1.7px;" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Dátum splatnosti:</b>
                    </td>
                    <td style="text-align: right;padding-right:4.8mm;">
                        <b>{ format_date( due )}</b>
                    </td>
                    <td style="padding-left:4.8mm;">
                        <b>Variabilný symbol:</b>
                    </td>
                    <td style="padding-left:4.8mm;padding-right:4.8mm;text-align: right;">
                        <b>{ reference }</b>
                    </td>
                </tr>
                <tr>
                    <td>
                        Dátum dodania:
                    </td>
                    <td style="text-align: right;padding-right:4.8mm;">
                        { format_date( issued )}
                    </td>
                    <td style="padding-left:4.8mm;">
                        <b>IBAN:</b>
                    </td>
                    <td style="padding-left:4.8mm;padding-right:4.8mm;text-align: right;margin-left:-4cm;">
                        <b>seller.banks</b>
                    </td>
                </tr>
                <tr>
                    <td>
                    </td>
                    <td style="text-align: right;padding-right:4.8mm;">
                    </td>
                    <td style="padding-left:4.8mm;">
                        BIC/SWIFT:
                    </td>
                    <td style="padding-left:4.8mm;padding-right:4.8mm;text-align: right;">
                        seller.banks
                    </td>
                </tr>
                <tr>
                    <td style="padding-top:4.8mm;vertical-align:bottom;padding-bottom:3.2px;">
                        Spôsob platby:
                    </td>
                    <td style="padding-top:4.8mm;text-align: right;padding-right:4.8mm;text-align: right;vertical-align:bottom;padding-bottom:3.2px;">
                        prevodom na účet
                    </td>
                    <td style="padding-top:4.8mm;padding-left:4.8mm;font-weight:bold;vertical-align:bottom;padding-bottom:3.2px;">
                        Čiastka k úhrade:
                    </td>
                    <td style="padding-top:4.8mm;padding-left:4.8mm;padding-right:4.8mm;font-size:22px;text-align: right;">#{ format_price( price, 2, 'font-weight:bold' )}</td>
                </tr>
            </table>
        </div>
        <table style="margin-bottom: 7.2mm;">
            <tr style="font-size:8px;color:#666;font-weight: medium;">
                <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;width:3%;"></td>
                <td style="padding-bottom: 1.2mm;border-bottom-width:0.5px;border-bottom-color:#000;width:39%;">NÁZOV POLOŽKY</td>
                <td style="padding-bottom: 1.2mm;border-bottom-width:0.5px;border-bottom-color:#000;width:8%;text-align:center;">KÓD</td>
                <td style="padding-right: 1.65mm;padding-bottom: 1.2mm;text-align: right;border-bottom-width:0.5px;border-bottom-color:#000;width:10%;">MNOŽSTVO</td>
                <td style="padding-right: 1.65mm;padding-bottom: 1.2mm;text-align: right;border-bottom-width:0.5px;border-bottom-color:#000;width:16%;">CENA ZA KUS</td>
                <td style="padding-bottom: 1.2mm;text-align: center;border-bottom-width:0.5px;border-bottom-color:#000;width:6%;">DPH</td>
                <td style="padding-bottom: 1.2mm;text-align: right;border-bottom-width:0.5px;border-bottom-color:#000;width:18%;">CELKOM S DPH</td>
            </tr>
            for( let i = 0; i < items.length; ++i )
            {
                let item = items[i];

                <tr>
                    <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;width:3%;">{ i + 1 }.</td>
                    <td style="border-right-width:0.5px;padding-top: 1.2mm;padding-bottom: 1.2mm;padding-right:1.6mm;font-weight: medium;line-height:1.25em;width:39%;">{ item.name }</td>
                    <td style="border-right-width:0.5px;padding-top: 1.2mm;padding-bottom: 1.2mm;width:8%;text-align:center;">{ parseInt( item.id ) < 4294967290 ? item.id : '' }</td>
                    <td style="border-right-width:0.5px;padding-right:1.6mm;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:10%;">#{ format_number( item.quantity, undefined, 'font-weight: medium;' )} ks</td>
                    <td style="border-right-width:0.5px;padding-right:1.6mm;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:16%;">
                        #{ format_price( item.price / ( 1 + item.vat ), 2, 'font-weight:medium' )}
                    </td>
                    <td style="border-right-width:0.5px;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: center;width:6%;">{ item.vat * 100 } %</td>
                    <td style="padding-left:1.6mm;padding-top: 1.2mm;padding-bottom:1.2mm;text-align: right;width:18%;">#{ format_price( item.quantity * item.price, 2, 'font-weight:bold' )}</td>
                </tr>
            }
        </table>
        <table>
            <tr>
                <td style="width:50%">
                {
                    let vats = {};
                    let tax = 0;

                    for( let item of items )
                    {
                        vats[ item.vat * 100 ] = ( vats[ item.vat * 100 ] || 0 ) + round( item.price * item.quantity, 2 );
                    }

                    <table>
                        <tr style="font-size:8px;color:#666;font-weight: medium;">
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;width:20%"></td>
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;text-align: right;width:28%">ZÁKLAD</td>
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;text-align: right;width:24%">DPH</td>
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;text-align: right;width:28%">CELKOM</td>
                        </tr>
                        for( let vat in vats )
                        {
                            tax += round( vats[vat], 2 ) - round( round( vats[vat], 2 ) / ( 1 + vat / 100 ), 4 );

                            <tr>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;width:22%">DPH { vat } %</td>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">
                                    #{ format_number( round( round( vats[vat], 2 ) / ( 1 + vat / 100 ), 4 ), 2 ) }
                                </td>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:24%">
                                    #{ format_number( round( vats[vat], 2 ) - round( round( vats[vat], 2 ) / ( 1 + vat / 100 ), 4 ), 2 ) }
                                </td>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">#{ format_number( vats[vat], 2 ) }</td>
                            </tr>
                        }
                        <tr>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;width:22%"><span style="font-weight: medium;">Celkom</span></td>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">
                                #{ format_number( price - tax, 2, 'font-weight: medium;' )}
                            </td>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:24%">
                                #{ format_number( tax, 2, 'font-weight: medium;' )}
                            </td>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">#{ format_number( price, 2, 'font-weight: medium;' )}</td>
                        </tr>
                        <tr>
                            <td colspan="4"><div style="margin-top:2.4mm">Rozpis DPH uvedený v mene { currency }</div></td>
                        </tr>
                    </table>
                }
                </td>
                <td style="width:50%">
                    <table>
                        <tr>
                            <td style="text-align: right;font-weight: medium;font-size:18px;padding-top:1mm;">Celkom</td>
                            <td style="text-align: right;font-size:22px;">#{ format_price( price, 2, 'font-weight:bold' ) }</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <div style="margin-left: -1.2cm;margin-right: -1.2cm;text-align: center;margin-top:10.8cm;background-color: #f0f0f0;padding-top:2mm;padding-bottom:2mm;color:#777;">
            info@hk-green.sk +421 222 000 27   1/1
        </div>/**/
    </main>
    <footer>
        <p style="margin-bottom: 20px;"><b>Dodávateľ:</b></p>
        <p style="font-size: 12px"><b>{ seller.name }</b></p>
        <p>{ seller.address }<br/>{ seller.zip } { seller.city }<br/>{ seller.country }</p>
        <p style="font-size: 8px; color: #2296D2; margin-top: 6px;">Spoločnosť je zapísaná v obchodnom registri okresného súdu Bratislava I, vložka 32203/B</p>
        <p style="text-align: center;margin-top:20px; font-size: 8px; color: #333;">Strana { $page }</p>
    </footer>
</pdf>